<!DOCTYPE html>
<html lang="es">
<% include ../partials/head %>

    <body>
        <% include ../partials/header %>
            <main class="form-section">
                <div class="form-container">
                    <h1 class="form-title">Editar Perfil</h1>

                    <form action="/users/edit/<%= user.id %>?_method=PUT" method="POST" enctype="multipart/form-data">

                        <div class="form-group">
                            <label for="first_name">Nombre:</label>
                            <input type="text" name="first_name" id="first_name" value="<%= user.first_name %>"
                                required />
                        </div>

                        <div class="form-group">
                            <label for="last_name">Apellido:</label>
                            <input type="text" name="last_name" id="last_name" value="<%= user.last_name %>" required />
                        </div>

                        <div class="form-group">
                            <label for="email">Correo electrónico:</label>
                            <input type="email" name="email" id="email" value="<%= user.email %>" required />
                        </div>

                        <div class="form-group">
                            <label for="phone">Teléfono:</label>
                            <input type="text" name="phone" id="phone" value="<%= user.phone || '' %>" />
                        </div>
                        <div class="form-group">
                            <label for="birthdate">Fecha de nacimiento:</label>
                            <% let birthdateFormatted='' ; if (user.birthdate) { const bd=new Date(user.birthdate); if
                                (!isNaN(bd)) { birthdateFormatted=bd.toISOString().split('T')[0]; } } %>
                                <input type="date" name="birthdate" id="birthdate"
                                    value="<%= user.birthdate ? new Date(user.birthdate).toISOString().split('T')[0] : '' %>" />
                        </div>

                        <div class="form-group">
                            <label for="gender">Género:</label>
                            <select name="gender" id="gender" class="gender-select">
                                <option value="Male" <%=user.gender==='Male' ? 'selected' : '' %>>Masculino</option>
                                <option value="Female" <%=user.gender==='Female' ? 'selected' : '' %>>Femenino</option>
                                <option value="Other" <%=user.gender==='Other' ? 'selected' : '' %>>Otro</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="profile_picture">Foto de perfil:</label>
                            <input type="file" name="profile_picture" id="profile_picture" />
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">Guardar cambios</button>
                    </form>

                    <div style="margin-top: 20px; text-align: center;">
                        <a href="/users/profile" class="btn btn-secondary" style="width: 100%;">Volver</a>
                    </div>
                </div>
            </main>
            <% include ../partials/footer %>
    </body>

</html>